# Карта нормалей

Чтобы определить форму объекта — можно использовать его вектор нормали. 

Цветовой вектор текстуры представлен как vec3(r, g, b). Аналогичным образом мы можем хранить vec3(x, y, z) компоненты вектора нормали в соответствующих цветовых компонентах. При этом стоит учитывать, что значения компонентов векторов нормалей задаются диапазоном от -1 до 1, поэтому необходимо сначала отобразить их в диапазоне [0,1].

```c++
vec3 _normal = normal * 0.5 + 0.5;
```

Все карты нормалей будет иметь синий оттенок. Всё из-за того, что нормали направлены вдоль положительной оси z с координатами (0,0,1): в результате получается синий цвет.

```c++
normal = texture(normalMap, texCoords).rgb;

// Переводим вектор нормали в диапазон [-1,1]
normal = normalize(normal * 2.0 - 1.0);   
```

# Преобразование нормалей с преобразованием положения объекта

Нужно найти TBN-матрицей (сокр. от «Tangent, Bitangent, Normal векторы»). Это те векторы, которые нам нужны для построения искомой матрицы, она преобразует нормали.

Мы уже знаем вектор-вверх, который является вектором нормали поверхности. Вектор-вправо и вектор-вперед являются касательным и бикасательным векторами соответственно. Их нужно найти.


```
E1 = dtU1*T + dtV1 * B
E2 = dtU2*T + dtV2 * B

|E1x E1y E1z| = |dtU1 dtV1|*|Tx Ty Tz|
|E2x E2y E2z|   |dtU2 dtV2|*|Bx By Bz|

|Tx Ty Tz| = |dtU1 dtV1|^-1 * |E1x E1y E1z|
|Bx By Bz|   |dtU2 dtV2|      |E2x E2y E2z|
```
